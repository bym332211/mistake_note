# 图片上传功能测试用例矩阵

## 测试目标
验证图片上传功能的正确性、健壮性和错误处理能力。

## 测试用例矩阵

| 测试用例 | 输入 | 预期输出 | 说明 |
|----------|------|----------|------|
| 上传有效图片 | 有效的JPG图片文件 | 返回成功状态，包含文件ID和URL | 验证基本功能正常 |
| 上传PNG格式 | 有效的PNG图片文件 | 返回成功状态 | 验证PNG格式支持 |
| 上传PDF格式 | 有效的PDF文件 | 返回成功状态 | 验证PDF格式支持 |
| 不支持格式 | TXT文本文件 | 返回400错误，提示不支持格式 | 验证格式限制 |
| 文件过大 | 超过10MB的图片 | 返回400错误，提示大小限制 | 验证大小限制 |
| 无文件上传 | 空请求 | 返回422验证错误 | 验证必填字段 |
| 健康检查 | GET /health请求 | 返回健康状态信息 | 验证系统状态接口 |
| 根端点检查 | GET /请求 | 返回系统运行状态 | 验证基础API可用性 |

## 测试分支覆盖

### 正常流程分支
- [x] 有效图片上传成功
- [x] 多种格式支持验证
- [x] 文件保存验证

### 边界条件分支
- [x] 文件大小边界（10MB限制）
- [x] 文件格式边界（支持/不支持格式）

### 异常分支
- [x] 无效文件格式处理
- [x] 过大文件处理
- [x] 缺失文件处理
- [x] 系统状态检查

### 业务特殊场景
- [x] 文件唯一性生成
- [x] 文件路径正确性
- [x] 响应数据完整性

## 测试数据准备

### 测试文件规格
- **有效图片**: 小于10MB的JPG/PNG/PDF文件
- **无效格式**: TXT/DOC等不支持格式
- **过大文件**: 超过10MB的图片文件

### 预期结果验证点
1. HTTP状态码正确性
2. 响应数据结构完整性
3. 文件实际保存验证
4. 错误消息清晰度
5. 系统状态准确性

## 测试执行说明

### 前置条件
- 后端服务正常运行
- 媒体目录可写权限
- 测试依赖包已安装

### 执行命令
```bash
pytest tests/test_image_upload.py -v
```

### 后置清理
- 自动清理临时测试文件
- 保留实际保存的测试文件用于验证
